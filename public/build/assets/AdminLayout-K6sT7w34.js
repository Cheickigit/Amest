import{k as se,l as oe,d as p,r as b,q as O,y as V,x as W,f as n,o,a as e,g as r,i as v,n as j,t as a,F as H,j as q,h as f,b as D,c as S,w,A as y,z as Z,G as ne,e as G,p as le,m as ae,s as ie,H as re}from"./app-B8f33P9o.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"flex items-center justify-between h-12 px-2"},ce={class:"flex items-center gap-2"},he={key:0,class:"font-display text-xl tracking-tight"},pe=["title"],ve={viewBox:"0 0 24 24",width:"14",height:"14"},fe=["d"],xe={key:0},me={class:"px-2 text-[11px] text-white/60 flex items-center gap-2"},ge={key:0},_e={class:"mt-4 space-y-1 text-sm"},be={class:"inline-flex w-6 justify-center"},we={viewBox:"0 0 24 24",width:"18",height:"18"},ye=["d"],ke={key:0,class:"flex-1 truncate"},Ce={key:1,class:"ml-auto inline-flex items-center justify-center px-2 h-5 rounded bg-bk-gold/20 text-bk-gold text-xs font-semibold"},ze={key:0,class:"pointer-events-none absolute left-[calc(100%+8px)] top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition bg-[#0f141a]/95 ring-1 ring-white/15 rounded-md px-2 py-1 text-xs whitespace-nowrap"},Be={key:0,class:"mt-6 text-[11px] text-white/45 px-2"},Le={class:"h-full flex flex-col"},je={class:"sticky top-0 z-30 h-14 border-b border-white/10 bg-bk-night/80 backdrop-blur flex items-center gap-2"},Ae={viewBox:"0 0 24 24",width:"20",height:"20"},Ee=["d"],Me={class:"absolute left-2 top-1/2 -translate-y-1/2 opacity-70 pointer-events-none"},Oe={viewBox:"0 0 24 24",width:"16",height:"16"},Ve=["d"],He={class:"ml-auto px-4 relative"},qe={class:"list-none flex items-center gap-3 cursor-pointer select-none"},De={class:"text-right hidden sm:block"},Se={class:"text-sm font-semibold truncate max-w-[180px]"},$e={class:"text-xs text-white/60 truncate max-w-[220px]"},Ke={class:"w-9 h-9 rounded-full bg-white/10 ring-1 ring-white/10 grid place-items-center font-bold"},Ne={class:"absolute right-4 mt-2 w-[320px] rounded-xl bg-[#0f141a]/95 ring-1 ring-white/15 backdrop-blur shadow-2xl p-2"},Ie={class:"px-3 py-2"},Re={class:"text-sm font-semibold"},Fe={class:"text-xs text-white/60"},Pe={class:"mt-2 flex flex-wrap gap-1"},Ue={key:0,class:"px-1.5 py-0.5 rounded bg-emerald-500/15 text-emerald-300 text-[10px]"},Te={key:0,class:"mt-1 text-[11px] text-white/45"},We={viewBox:"0 0 24 24",width:"16",height:"16"},Ze=["d"],Ge={viewBox:"0 0 24 24",width:"16",height:"16"},Qe=["d"],Ye={viewBox:"0 0 24 24",width:"16",height:"16"},Je=["d"],Xe={viewBox:"0 0 24 24",width:"16",height:"16"},et=["d"],tt={viewBox:"0 0 24 24",width:"16",height:"16"},st=["d"],ot={viewBox:"0 0 24 24",width:"16",height:"16"},nt=["d"],lt={viewBox:"0 0 24 24",width:"16",height:"16"},at=["d"],it={class:"flex-1 overflow-y-auto p-6"},rt={class:"rounded-2xl overflow-hidden ring-1 ring-white/15 bg-[#0f141a]/95"},dt={class:"relative"},ut={class:"max-h-80 overflow-y-auto divide-y divide-white/10"},ct=["onClick"],ht={viewBox:"0 0 24 24",width:"16",height:"16"},pt=["d"],vt={class:"text-sm"},ft={class:"ml-auto text-[11px] text-white/40"},xt={key:0,class:"px-4 py-6 text-sm text-white/60"},mt=se({__name:"AdminLayout",setup(gt){const k=oe(),u=p(()=>k.props.auth?.user??null),z=p(()=>k.props.adminCounts??{leads:0,drafts:0}),A=p(()=>u.value?.name||"Compte"),$=p(()=>u.value?.email||""),m=s=>!!u.value?.roles?.includes(s),g=s=>!!u.value?.permissions?.includes(s),Q=p(()=>window?.Ziggy);function c(s,t,l=!1){try{return ie(s,t??{},l,Q.value)}catch{return"#"}}const _=b(!0),i=b(!1);O(()=>{_.value=(localStorage.getItem("bko.sb")??"1")==="1",i.value=(localStorage.getItem("bko.sb.c")??"0")==="1"}),V(_,s=>localStorage.setItem("bko.sb",s?"1":"0")),V(i,s=>localStorage.setItem("bko.sb.c",s?"1":"0"));function Y(){window.innerWidth<768&&(_.value=!1)}const B=b(typeof navigator<"u"?navigator.onLine:!0),K=()=>B.value=!0,N=()=>B.value=!1;O(()=>{addEventListener("online",K),addEventListener("offline",N)}),W(()=>{removeEventListener("online",K),removeEventListener("offline",N)});const E=p(()=>k.url||k.props.url||(typeof window<"u"?window.location.pathname+window.location.search:""));function J(s){return E.value===s||E.value===`${s}/`}function X(s){return s.some(t=>E.value.startsWith(t.startsWith("/")?t:`/${t}`))}const d={dash:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z",projects:"M3 5h18v2H3V5zm0 6h18v2H3v-2zm0 6h12v2H3v-2z",quotes:"M21 6h-8l-2-2H3v16h18V6z",posts:"M4 4h16v2H4V4zm0 5h16v2H4V9zm0 5h10v2H4v-2z",users:"M16 11a4 4 0 1 0-8 0a4 4 0 0 0 8 0zM4 20a8 8 0 1 1 16 0H4z",settings:"M19.14 12.94a7.07 7.07 0 0 0 0-1.88l2.03-1.58l-1.92-3.32l-2.39.96a7.1 7.1 0 0 0-1.62-.94l-.36-2.54h-3.84l-.36 2.54c-.58.23-1.12.54-1.62.94l-2.39-.96L2.7 8.84l2.03 1.58a7.07 7.07 0 0 0 0 1.88L2.82 14.6l1.92 3.32l2.39-.96c.5.4 1.04.71 1.62.94l.36 2.54h3.84l.36-2.54c.58-.23 1.12-.54 1.62-.94l2.39.96l1.92-3.32l-2.03-1.66zM12 15a3 3 0 1 1 0-6 3 3 0 0 1 0 6z",security:"M12 1l9 4v6c0 5-3.8 9.7-9 11c-5.2-1.3-9-6-9-11V5l9-4zM7 11h10v2H7z",search:"M10 2a8 8 0 1 0 5.29 14.29l4.21 4.21l1.41-1.41l-4.21-4.21A8 8 0 0 0 10 2z"};function I(s){return d[s]??d.dash}const R=p(()=>[{label:"Tableau de bord",icon:"dash",route:"admin.dashboard",activeOn:["/admin"],enabled:!0,exact:!0},{label:"Réalisations",icon:"projects",route:"admin.projects.index",activeOn:["/admin/projects"],enabled:g("projects.view")||m("admin")},{label:"Devis & leads",icon:"quotes",route:"admin.quotes.index",activeOn:["/admin/quotes"],enabled:g("quotes.view")||m("admin"),badge:()=>z.value.leads??0},{label:"Actualités",icon:"posts",route:"admin.posts.index",activeOn:["/admin/posts"],enabled:g("cms.manage")||m("admin"),badge:()=>z.value.drafts??0},{label:"Compte & sécurité",icon:"security",route:"admin.account.security",activeOn:["/admin/account"],enabled:!0}]);function F(s){return s.exact?J("/admin"):X(s.activeOn)}const x=b(!1),L=b(""),P=p(()=>R.value.filter(s=>s.enabled).filter(s=>s.label.toLowerCase().includes(L.value.toLowerCase())));function M(){x.value=!0,requestAnimationFrame(()=>document.getElementById("cmdk")?.focus())}function ee(s){Z.visit(c(s)),x.value=!1,L.value=""}function U(s){(s.metaKey||s.ctrlKey)&&s.key.toLowerCase()==="k"&&(s.preventDefault(),M()),s.key==="Escape"&&(x.value&&(x.value=!1),h())}const C=b(null);function h(){C.value&&(C.value.open=!1)}function T(s){C.value&&!C.value.contains(s.target)&&h()}O(()=>{document.addEventListener("click",T,{passive:!0}),document.addEventListener("keydown",U)}),W(()=>{document.removeEventListener("click",T),document.removeEventListener("keydown",U)}),V(()=>k.url,()=>h());const te=new Date().getFullYear();return(s,t)=>(o(),n("div",{class:j(["h-screen bg-bk-night text-bk-off overflow-hidden",i.value?"md:pl-20":"md:pl-72"])},[e("aside",{class:j(["fixed inset-y-0 left-0 z-40 p-4 border-r border-white/10 overflow-y-auto transition-transform","backdrop-blur bg-[radial-gradient(1200px_600px_at_-10%_-20%,rgba(220,193,118,.10),transparent),linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02))]",_.value?"translate-x-0":"-translate-x-full md:translate-x-0",i.value?"w-20":"w-72"])},[e("div",ue,[e("div",ce,[t[8]||(t[8]=e("img",{src:"/assets/logo-bk.jpeg",class:"h-8 w-auto object-contain rounded-sm",alt:"BKO Construction"},null,-1)),i.value?r("",!0):(o(),n("div",he,[...t[7]||(t[7]=[v(" BKO ",-1),e("span",{class:"text-bk-gold"},"Construction",-1)])]))]),e("button",{type:"button",class:"hidden md:inline-flex items-center gap-1 text-xs rounded-md px-2 py-1 bg-white/10 ring-1 ring-white/15 hover:ring-bk-gold/50",title:i.value?"Étendre":"Réduire",onClick:t[0]||(t[0]=l=>i.value=!i.value)},[(o(),n("svg",ve,[e("path",{d:d.dash,fill:"currentColor"},null,8,fe)])),i.value?r("",!0):(o(),n("span",xe,"Réduire"))],8,pe)]),e("div",me,[e("span",{class:j(["inline-block w-2 h-2 rounded-full",B.value?"bg-emerald-400":"bg-red-400"])},null,2),i.value?r("",!0):(o(),n("span",ge,a(B.value?"En ligne":"Hors ligne"),1))]),e("nav",_e,[(o(!0),n(H,null,q(R.value,l=>G((o(),n("div",{key:l.route,class:"group relative"},[D(f(y),{href:c(l.route),prefetch:"",onClick:Y,"aria-current":F(l)?"page":void 0,class:j(["flex items-center gap-3 px-3 py-2 rounded-lg transition",F(l)?"bg-bk-gold text-bk-night shadow-[0_18px_38px_-18px_rgba(220,193,118,.60)]":"hover:bg-white/10"])},{default:w(()=>[e("span",be,[(o(),n("svg",we,[e("path",{d:I(l.icon),fill:"currentColor"},null,8,ye)]))]),i.value?r("",!0):(o(),n("span",ke,a(l.label),1)),l.badge&&!i.value?(o(),n("span",Ce,a(l.badge()),1)):r("",!0)]),_:2},1032,["href","aria-current","class"]),i.value?(o(),n("div",ze,a(l.label),1)):r("",!0)])),[[re,l.enabled]])),128))]),i.value?r("",!0):(o(),n("div",Be," © "+a(f(te))+" BKO Construction · Back-office ",1))],2),e("div",Le,[e("header",je,[e("button",{type:"button",class:"p-3 md:hidden",onClick:t[1]||(t[1]=l=>_.value=!_.value),"aria-label":"Menu"},[(o(),n("svg",Ae,[e("path",{d:d.dash,fill:"currentColor"},null,8,Ee)]))]),e("div",{class:"relative hidden sm:block ml-1",onClick:M},[t[9]||(t[9]=e("input",{id:"hdr-search",readonly:"",placeholder:"Rechercher (⌘/Ctrl K)",class:"h-9 w-[280px] rounded-lg bg-white/[.06] ring-1 ring-white/10 pl-8 pr-3 text-sm outline-none cursor-text"},null,-1)),e("span",Me,[(o(),n("svg",Oe,[e("path",{d:d.search,fill:"currentColor"},null,8,Ve)]))])]),e("div",He,[e("details",{class:"group",ref_key:"accountRef",ref:C},[e("summary",qe,[e("div",De,[e("div",Se,a(A.value),1),e("div",$e,a($.value),1)]),e("div",Ke,a(A.value.substring(0,1).toUpperCase()),1)]),e("div",Ne,[e("div",Ie,[e("div",Re,a(A.value),1),e("div",Fe,a($.value),1),e("div",Pe,[(o(!0),n(H,null,q(u.value?.roles||[],l=>(o(),n("span",{key:l,class:"px-1.5 py-0.5 rounded bg-white/10 text-[10px] uppercase tracking-wide"},a(l),1))),128)),u.value?.two_factor_enabled?(o(),n("span",Ue," 2FA ON ")):r("",!0)]),u.value?.last_login_at?(o(),n("div",Te," Dernière connexion : "+a(u.value?.last_login_at),1)):r("",!0)]),t[16]||(t[16]=e("div",{class:"my-1 h-px bg-white/10"},null,-1)),D(f(y),{href:c("admin.account.security"),onClick:h,class:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10"},{default:w(()=>[(o(),n("svg",We,[e("path",{d:d.security,fill:"currentColor"},null,8,Ze)])),t[10]||(t[10]=v(" Compte & sécurité ",-1))]),_:1},8,["href"]),g("cms.manage")||m("admin")?(o(),S(f(y),{key:0,href:c("admin.posts.index"),onClick:h,class:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10"},{default:w(()=>[(o(),n("svg",Ge,[e("path",{d:d.posts,fill:"currentColor"},null,8,Qe)])),v(" Actualités ("+a(z.value.drafts??0)+") ",1)]),_:1},8,["href"])):r("",!0),g("projects.create")||m("admin")?(o(),S(f(y),{key:1,href:c("admin.projects.create"),onClick:h,class:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10"},{default:w(()=>[(o(),n("svg",Ye,[e("path",{d:d.projects,fill:"currentColor"},null,8,Je)])),t[11]||(t[11]=v(" Nouveau projet ",-1))]),_:1},8,["href"])):r("",!0),g("quotes.view")||m("admin")?(o(),S(f(y),{key:2,href:c("admin.quotes.index"),onClick:h,class:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10"},{default:w(()=>[(o(),n("svg",Xe,[e("path",{d:d.quotes,fill:"currentColor"},null,8,et)])),v(" Devis & leads ("+a(z.value.leads??0)+") ",1)]),_:1},8,["href"])):r("",!0),D(f(y),{href:c("home"),onClick:h,class:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10"},{default:w(()=>[(o(),n("svg",tt,[e("path",{d:d.dash,fill:"currentColor"},null,8,st)])),t[12]||(t[12]=v(" Voir le site ",-1))]),_:1},8,["href"]),e("button",{type:"button",class:"w-full text-left flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10",onClick:M},[(o(),n("svg",ot,[e("path",{d:d.search,fill:"currentColor"},null,8,nt)])),t[13]||(t[13]=v(" Palette de commandes ",-1)),t[14]||(t[14]=e("span",{class:"ml-auto text-[11px] text-white/50"},"⌘/Ctrl K",-1))]),t[17]||(t[17]=e("div",{class:"my-1 h-px bg-white/10"},null,-1)),e("button",{type:"button",class:"w-full text-left flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10",onClick:t[2]||(t[2]=l=>f(Z).post(c("logout")))},[(o(),n("svg",lt,[e("path",{d:d.settings,fill:"currentColor"},null,8,at)])),t[15]||(t[15]=v(" Déconnexion ",-1))])])],512)])]),e("main",it,[ne(s.$slots,"default",{},void 0,!0)])]),x.value?(o(),n("div",{key:0,class:"fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm",onClick:t[6]||(t[6]=l=>x.value=!1)},[e("div",{class:"max-w-xl mx-auto mt-28 px-4",onClick:t[5]||(t[5]=ae(()=>{},["stop"]))},[e("div",rt,[e("div",dt,[G(e("input",{id:"cmdk","onUpdate:modelValue":t[3]||(t[3]=l=>L.value=l),placeholder:"Aller à… — ESC pour fermer",class:"w-full h-12 bg-transparent px-4 pr-12 outline-none text-sm placeholder:text-white/50"},null,512),[[le,L.value]]),e("button",{type:"button",class:"absolute right-3 top-1/2 -translate-y-1/2 text-white/60 hover:text-white",onClick:t[4]||(t[4]=l=>x.value=!1)},"✕")]),e("div",ut,[(o(!0),n(H,null,q(P.value,l=>(o(),n("button",{key:l.route,type:"button",class:"w-full px-4 py-2.5 text-left hover:bg-white/5 flex items-center gap-3",onClick:_t=>ee(l.route)},[(o(),n("svg",ht,[e("path",{d:I(l.icon),fill:"currentColor"},null,8,pt)])),e("span",vt,a(l.label),1),e("span",ft,a(l.route),1)],8,ct))),128)),P.value.length?r("",!0):(o(),n("div",xt,"Aucune correspondance."))])])])])):r("",!0)],2))}}),yt=de(mt,[["__scopeId","data-v-2440616f"]]);export{yt as A};
