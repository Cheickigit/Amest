import{k as j,d as L,u as S,r as w,y as T,x as B,f as a,o as d,a as t,g as f,t as b,b as F,w as I,i as m,s as R,h as o,A,B as N,e as u,p as g,C as D,D as M,m as y,F as O,j as $,z}from"./app-B8f33P9o.js";import{A as E}from"./AdminLayout-K6sT7w34.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"max-w-5xl mx-auto text-bk-off"},q={class:"flex items-center justify-between mb-4"},Z={class:"text-2xl font-extrabold"},G={class:"flex items-center gap-2"},H=["disabled"],J={key:0,class:"h-1 mb-4 rounded bg-white/10 overflow-hidden"},Q={key:1,class:"mb-4 rounded-xl bg-red-500/10 ring-1 ring-red-500/30 text-red-200 px-4 py-3"},W={class:"grid md:grid-cols-2 gap-4"},X={class:"grid gap-1"},Y={class:"grid gap-1"},ee={class:"grid md:grid-cols-3 gap-4"},te={class:"grid gap-1"},se={class:"relative"},oe={class:"grid gap-1 md:col-span-2"},le={class:"grid gap-1"},ie={class:"grid gap-1"},ne={class:"grid md:grid-cols-2 gap-4"},re={class:"grid gap-1"},ae={key:0,class:"text-xs text-bk-off/60"},de={class:"underline"},ue={class:"grid gap-1"},ge={class:"flex gap-2"},pe=["onKeyup"],fe={class:"flex flex-wrap gap-2 mt-2"},ce=["onClick"],be={key:2,class:"mt-6 rounded-2xl overflow-hidden ring-1 ring-white/10 bg-white/[.04]"},me={class:"aspect-video bg-white/5"},xe=["src"],ve=["src"],ke=j({layout:E,__name:"Form",props:{item:{}},setup(_){const p=(i,e,l=!1)=>R(i,e??{},l,window.Ziggy),n=_,c=L(()=>!!n.item?.id),s=S({title:n.item?.title??"",slug:n.item?.slug??"",status:n.item?.status??"brouillon",published_at:n.item?.published_at??"",excerpt:n.item?.excerpt??"",body:n.item?.body??"",cover:null,tags:n.item?.tags??[],tagInput:""}),x=w(!1),U=i=>i.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,200);T(()=>s.title,i=>{x.value||(s.slug=U(String(i||"")))});const r=w(null);function C(i){const e=i.target.files?.[0]||null;s.cover=e,r.value&&URL.revokeObjectURL(r.value),r.value=e?URL.createObjectURL(e):null}B(()=>{r.value&&URL.revokeObjectURL(r.value)});function v(){const i=s.tagInput.trim();if(i){if(i.length>40)return alert("Tag trop long");s.tags.push(i),s.tagInput=""}}function V(i){s.tags.splice(i,1)}function k(){const i=c.value?p("admin.posts.update",n.item.id):p("admin.posts.store");s.transform(e=>({...e,...c.value?{_method:"PUT"}:{}})),s.post(i,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>z.visit(p("admin.posts.index")),onFinish:()=>s.transform(e=>({...e,_method:void 0}))})}return(i,e)=>(d(),a("div",P,[t("div",q,[t("div",null,[e[8]||(e[8]=t("div",{class:"text-[11px] text-bk-off/60"},"BKO Construction / Back-office",-1)),t("h1",Z,b(c.value?"Modifier un article":"Nouvel article"),1)]),t("div",G,[F(o(A),{href:p("admin.posts.index"),class:"px-3 h-10 inline-flex items-center rounded-lg bg-white/10 hover:bg-white/15 text-bk-off"},{default:I(()=>[...e[9]||(e[9]=[m(" Retour ",-1)])]),_:1},8,["href"]),t("button",{type:"button",disabled:o(s).processing,onClick:k,class:"px-4 h-10 inline-flex items-center gap-2 rounded-lg bg-bk-gold text-bk-night font-bold hover:brightness-95 disabled:opacity-60"}," Enregistrer ",8,H)])]),o(s).progress?(d(),a("div",J,[t("div",{class:"h-1 bg-bk-gold",style:N({width:`${o(s).progress.percentage}%`})},null,4)])):f("",!0),Object.keys(o(s).errors).length?(d(),a("div",Q," Merci de corriger les champs indiqués ci-dessous. ")):f("",!0),t("form",{onSubmit:y(k,["prevent"]),class:"grid gap-5"},[t("div",W,[t("label",X,[e[10]||(e[10]=t("span",{class:"text-bk-off/70 text-sm"},"Titre *",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).title=l),required:"",class:"bg-white/[.06] ring-1 ring-white/10 rounded-lg px-3 py-2 outline-none text-bk-off placeholder:text-bk-off/50 focus:ring-bk-gold/50"},null,512),[[g,o(s).title]])]),t("label",Y,[e[11]||(e[11]=t("span",{class:"text-bk-off/70 text-sm"},"Slug",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o(s).slug=l),onInput:e[2]||(e[2]=l=>x.value=!0),class:"bg-white/[.06] ring-1 ring-white/10 rounded-lg px-3 py-2 outline-none text-bk-off placeholder:text-bk-off/50 focus:ring-bk-gold/50"},null,544),[[g,o(s).slug]])])]),t("div",ee,[t("label",te,[e[14]||(e[14]=t("span",{class:"text-bk-off/70 text-sm"},"Statut",-1)),t("div",se,[u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o(s).status=l),class:"h-10 w-full appearance-none rounded-lg bg-white/[.06] ring-1 ring-white/10 px-3 pr-8 outline-none text-bk-off [color-scheme:dark] focus:ring-bk-gold/50"},[...e[12]||(e[12]=[t("option",{value:"brouillon"},"Brouillon",-1),t("option",{value:"publié"},"Publié",-1)])],512),[[D,o(s).status]]),e[13]||(e[13]=t("span",{class:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 opacity-70"},"▾",-1))])]),t("label",oe,[e[15]||(e[15]=t("span",{class:"text-bk-off/70 text-sm"},"Publication (optionnel)",-1)),u(t("input",{type:"datetime-local","onUpdate:modelValue":e[4]||(e[4]=l=>o(s).published_at=l),class:"h-10 rounded-lg bg-white/[.06] ring-1 ring-white/10 px-3 outline-none text-bk-off placeholder:text-bk-off/50 [color-scheme:dark] focus:ring-bk-gold/50"},null,512),[[g,o(s).published_at]])])]),t("label",le,[e[16]||(e[16]=t("span",{class:"text-bk-off/70 text-sm"},"Résumé",-1)),u(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).excerpt=l),rows:"2",class:"bg-white/[.06] ring-1 ring-white/10 rounded-lg px-3 py-2 outline-none text-bk-off placeholder:text-bk-off/50 focus:ring-bk-gold/50"},null,512),[[g,o(s).excerpt]])]),t("label",ie,[e[17]||(e[17]=t("span",{class:"text-bk-off/70 text-sm"},"Contenu",-1)),u(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).body=l),rows:"8",class:"bg-white/[.06] ring-1 ring-white/10 rounded-lg px-3 py-2 outline-none text-bk-off placeholder:text-bk-off/50 focus:ring-bk-gold/50"},null,512),[[g,o(s).body]])]),t("div",ne,[t("label",re,[e[19]||(e[19]=t("span",{class:"text-bk-off/70 text-sm"},"Image de couverture",-1)),t("input",{type:"file",accept:"image/*",onChange:C,class:"text-bk-off [color-scheme:dark]"},null,32),n.item?.cover_image&&!r.value?(d(),a("div",ae,[e[18]||(e[18]=m(" Actuelle : ",-1)),t("span",de,"/storage/"+b(n.item.cover_image),1)])):f("",!0)]),t("div",ue,[e[20]||(e[20]=t("span",{class:"text-bk-off/70 text-sm"},"Tags",-1)),t("div",ge,[u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o(s).tagInput=l),class:"flex-1 bg-white/[.06] ring-1 ring-white/10 rounded-lg px-3 py-2 outline-none text-bk-off placeholder:text-bk-off/50 focus:ring-bk-gold/50",onKeyup:M(y(v,["prevent"]),["enter"])},null,40,pe),[[g,o(s).tagInput]]),t("button",{type:"button",onClick:v,class:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/15 text-bk-off"}," Ajouter ")]),t("div",fe,[(d(!0),a(O,null,$(o(s).tags,(l,h)=>(d(),a("span",{key:h,class:"px-2 h-7 inline-flex items-center rounded-md bg-white/10 text-sm text-bk-off"},[m(b(l)+" ",1),t("button",{type:"button",class:"ml-2 text-bk-off/60 hover:text-bk-off",onClick:he=>V(h)},"✕",8,ce)]))),128))])])]),e[21]||(e[21]=t("div",null,[t("button",{class:"px-4 h-10 inline-flex items-center rounded-lg bg-bk-gold text-bk-night font-bold hover:brightness-95"}," Enregistrer ")],-1))],32),r.value||n.item?.cover_image?(d(),a("div",be,[e[22]||(e[22]=t("div",{class:"p-3 text-sm text-bk-off/70"},"Aperçu — image de couverture",-1)),t("div",me,[r.value?(d(),a("img",{key:0,src:r.value,class:"w-full h-full object-cover"},null,8,xe)):(d(),a("img",{key:1,src:`/storage/${n.item?.cover_image}`,class:"w-full h-full object-cover"},null,8,ve))])])):f("",!0)]))}}),Ue=K(ke,[["__scopeId","data-v-0727f2f3"]]);export{Ue as default};
